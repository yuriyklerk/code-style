# Стиль кода и используемые стандарты PHP

**1. Переменные**

1.1. Переменная должна в полной мере описывать представляемую сущность. Исходя из ее названия, 
должно быть понятно, ее предназначение. Имя переменной должно отражать решение задачи реального мира, 
а не решение на языке программирования.

1.2. Умеренная длина. Название переменной недолжно быть слишком коротким ($arr1), и не слишком длинным. Длина должна 
быть достаточной, для легкого и удобного восприятия.

1.3. Однозначность в именовании. Плохо, когда название переменной, имеет неоднозначный смысл.

1.4. Переменные следует называть в стиле camelCase либо under_score.

**Хороший пример именования переменных:**
 > usersCount, userMonthWorkDaysCount, yearTax, maxComputedSalary 


**Плохой пример:**
 > x, $fb, f_ar_type_data, f_obj_result, inputData, returnValue, resultArray, obj1, obj2 

**Общие рекомендации использования переменных:**

1. Использовать каждую переменную только с одной целью.
2. Инициализировать переменные значением по умолчанию.
3. Располагать команды использующие одну и туже переменную как можно
ближе друг к другу.
4. Имена булевых переменных должны быть в утвердительной форме и подразумевать булево значение: done, error, found, finished. Плохо: status, source.
5. Избегать имен с похожими значениями (в рамках конкретной области видимости): fileNumber/fileIndex; scoresNumber/scoresCount. Применять только один из вариантов. Пишите имена без орфографических ошибок и опечаток.

**2. Константы:**

2.1. Константам необходимо давать имена в верхнем регистре и использовать нижнее подчеркивание в качестве разделителя:
Например:
```php
  const VERSION = '1.0';
  const DATE_APPROVED = '2012-06-01';
```

2.2. Префиксы в перечислениях (на примере статусов). При использовании перечислений, имеет смысл стави ть префикс.
```php
  const STATUS_OPENED = false;
  const STATUS_INPROGRESS = false;
  const STATUS_CLOSED = false;

```
**3. Методы:**

3.1.1. Методам необходимо давать имена в стиле camelCase().


3.1.2. Видимость НЕОБХОДИМО объявлять для всех методов.

3.1.3. НЕ СЛЕДУЕТ начинать название метода с подчёркивания для обозначения приватной или защищённой видимости.

3.1.4. НЕДОПУСТИМО объявлять методы с пробелом после названия метода. Открывающую фигурную скобку НЕОБХОДИМО располагать на отдельной строке; закрывающую фигурную скобку НЕОБХОДИМО располагать на следующей строке после тела метода. НЕДОПУСТИМО оставлять пробел после открывающей круглой скобки и перед закрывающей.

3.1.5. В списке аргументов НЕДОПУСТИМЫ пробелы перед запятыми и НЕОБХОДИМ один пробел после каждой запятой.

3.1.6. Аргументы метода со значениями по умолчанию НЕОБХОДИМО располагать в конце списка аргументов.

3.1.7. Объявление метода выглядит как показано ниже. Обратите внимание на расположение запятых, пробелов, круглых, квадратных и фигурных скобок:

```php

namespace Vendor\Package;

class ClassName
{
    public function fooBarBaz($arg1, &$arg2, $arg3 = [])
    {
        // тело метода
    }
}
```

3.1.8. Список аргументов МОЖНО разбить на несколько строк, каждая из которых с одним отступом. При этом первый аргумент в списке НЕОБХОДИМО перенести на следующую строку, и в каждой строке НЕОБХОДИМО указать только один аргумент.

3.1.9. Когда список аргументов разбит на несколько строк, закрывающую круглую скобку и открывающую фигурную НЕОБХОДИМО располагать на одной отдельной строке, с одним пробелом между ними.

```php

namespace Vendor\Package;

class ClassName
{
    public function aVeryLongMethodName(
        ClassTypeHint $arg1,
        &$arg2,
        array $arg3 = []
    ) {
        // тело метода
    }
}
```

3.2.1. При вызове метода или функции НЕДОПУСТИМЫ пробелы между названием метода или функции и открывающей круглой скобкой, а также НЕДОПУСТИМЫ пробелы после открывающей круглой скобки и перед закрывающей. В списке аргументов НЕДОПУСТИМЫ пробелы перед запятыми, и НЕОБХОДИМ один пробел после каждой запятой.

```php

bar();
$foo->bar($arg1);
Foo::bar($arg2, $arg3);
```

3.2.2. Список аргументов МОЖНО разбить на несколько строк, каждая из которых с одним отступом. При этом первый аргумент в списке НЕОБХОДИМО перенести на следующую строку, и в каждой строке НЕОБХОДИМО указать только один аргумент.

```php

$foo->bar(
    $longArgument,
    $longerArgument,
    $muchLongerArgument
);
```

**4. Классы:**

4.1. Имена классов должны быть объявлены с использованием «StudlyCaps» (каждое слово начинается с большой буквы, между словами нет разделителей).

**5. Файлы:**

5.1. PHP-код ОБЯЗАТЕЛЬНО следует заключать в полную версию (```<?php ?>```) тегов или укороченную (сокращённую запись echo) версию (```<?= ?>```) тегов и НЕДОПУСТИМО заключать ни в какие иные разновидности тегов.

5.2. PHP-код ДОЛЖЕН быть представлен только в кодировке UTF-8 без BOM-байта.

5.3. В файлах СЛЕДУЕТ либо объявлять структуры (классы, функции, константы и т.п.) и не создавать побочных эффектов 
(например: передавать данные в выходной поток, модифицировать настройки и т.п.), либо реализовывать логику, порождающую побочные эффекты, но НЕ СЛЕДУЕТ делать одновременно и то, и другое.

5.4. Полностью определённое пространство имён и имя класса должны иметь следующую структуру:

```  \<Vendor Name>\(<Namespace>\)*<Class Name> ```

5.5. Каждый разделитель пространства имён при обращении к файловой системе преобразуется в ```РАЗДЕЛИТЕЛЬ_ИМЁН_КАТАЛОГОВ```.
Каждый символ _ («знак подчёркивания») в ```ИМЕНИ_КЛАССА``` преобразуется в  ```РАЗДЕЛИТЕЛЬ_ИМЁН_КАТАЛОГОВ```.

5.6. Все PHP-файлы НЕОБХОДИМО заканчивать одной пустой строкой.

5.7. Закрывающий тэг ?> НЕОБХОДИМО удалять из файлов, содержащих только PHP.


**6. Отступы:**

6.1.1. Для отступов НЕОБХОДИМО использовать 4 пробела, а не табы.

6.1.2. НЕДОПУСТИМО жёстко ограничивать длину строки; мягкое ограничение длины строки ДОЛЖНО быть 120 символов; строки СЛЕДУЕТ делать не длиннее 80 символов.

6.1.3. НЕОБХОДИМО оставлять одну пустую строку после объявления пространства имён (namespace) и НЕОБХОДИМО оставлять одну пустую строку после блока операторов use.

6.1.4. Открывающие фигурные скобки классов НЕОБХОДИМО переносить на следующую строку, а закрывающие фигурные скобки переносить на следующую строку после тела.

6.1.5. Видимость НЕОБХОДИМО объявлять для всех свойств и методов; abstract и final НЕОБХОДИМО ставить перед модификатором видимости; static НЕОБХОДИМО ставить после модификатора видимости.

6.1.6. После ключевых слов управляющих структур НЕОБХОДИМО ставить один пробел; после названий функций и методов — НЕДОПУСТИМО.

6.1.7. Открывающие фигурные скобки управляющих структур НЕОБХОДИМО оставлять на той же строке, а закрывающие фигурные скобки переносить на следующую строку после тела.

6.1.8. НЕДОПУСТИМО ставить пробел после открывающих круглых скобок управляющих структур и НЕДОПУСТИМО ставить пробел перед закрывающими круглыми скобками управляющих структур.

6.1.9. НЕДОПУСТИМО оставлять пробелы в конце непустых строк.

6.2.1. МОЖНО использовать пустые строки для улучшения читаемости и обозначения связанных блоков кода.

6.2.2. НЕДОПУСТИМО писать на одной строке более одной инструкции.

6.2.3. Ключевые слова PHP НЕОБХОДИМО писать в нижнем регистре. (Никаких ```FALSE```, ```NULL``` быть не должно)

6.2.4. НЕОБХОДИМО использовать один оператор ```use``` на одно объявление (импорт или создание псевдонима).

6.2.5. НЕОБХОДИМО оставлять одну пустую строку после блока операторов ```use```.


**Пример стиля написания кода:**
```php

namespace Vendor\Package;

use FooInterface;
use BarClass as Bar;
use OtherVendor\OtherPackage\BazClass;

class Foo extends Bar implements FooInterface
{
    public function sampleFunction($a, $b = null)
    {
        if ($a === $b) {
            bar();
        } elseif ($a > $b) {
            $foo->bar($arg1);
        } else {
            BazClass::bar($arg2, $arg3);
        }
    }

    final public static function bar()
    {
        // тело метода
    }
}
```

6.2.6. Ключевые слова extends и implements НЕОБХОДИМО располагать на одной строке с именем класса.

6.2.7. Открывающую фигурную скобку класса НЕОБХОДИМО переносить на следующую строку; закрывающую фигурную скобку класса НЕОБХОДИМО располагать на следующей строке после тела класса.

```php

namespace Vendor\Package;

use FooClass;
use BarClass as Bar;
use OtherVendor\OtherPackage\BazClass;

class ClassName extends ParentClass implements \ArrayAccess, \Countable
{
    // константы, свойства, методы
}
```

6.2.8. Список implements МОЖНО разбить на несколько строк, каждая из которых с одним отступом. При этом первый интерфейс в списке НЕОБХОДИМО перенести на следующую строку, и в каждой строке НЕОБХОДИМО указать только один интерфейс.

```php

namespace Vendor\Package;

use FooClass;
use BarClass as Bar;
use OtherVendor\OtherPackage\BazClass;

class ClassName extends ParentClass implements
    \ArrayAccess,
    \Countable,
    \Serializable
{
    // константы, свойства, методы
}
```
**7. Свойства:**

7.1.1. Видимость НЕОБХОДИМО объявлять для всех свойств.

7.1.2. Использовать ключевое слово var для объявления свойств НЕДОПУСТИМО.

7.1.3. НЕДОПУСТИМО в одном объявлении указывать более одного свойства.

7.1.4. НЕ СЛЕДУЕТ начинать название свойства с подчёркивания для обозначения приватной или защищённой видимости.

**Пример:**
```php

namespace Vendor\Package;

class ClassName
{
    public $foo = null;
}
```
**8. Управляющие структуры (if, else, elseif)** 

8.1. Вместо ```else if``` СЛЕДУЕТ использовать ```elseif```, чтобы все ключевые слова управляющих структур выглядели как одно слово.

```php

if ($isPrepared) {
    // тело if
} elseif ($isCompleted) {
    // тело elseif
} else {
    // тело else;
}
```
**9. Управляющая структура switch:**

9.1. Управляющая структура ```switch``` выглядит, как показано ниже. Обратите внимание на расположение пробелов, круглых и фигурных скобок: выражение case НЕОБХОДИМО смещать на один отступ от ```switch```, а ключевое слово ```break``` (или другое завершающее ключевое слово) НЕОБХОДИМО смещать на тот же уровень, что и тело ```case```. При умышленном проваливании из непустого case НЕОБХОДИМ комментарий вроде ```// no break```.

```php

switch ($expr) {
    case 0:
        echo 'Первый case, заканчивается на break';
        break;
    case 1:
        echo 'Второй case, с умышленным проваливанием';
        // no break
    case 2:
    case 3:
    case 4:
        echo 'Третий case, завершается словом return вместо break';
        return;
    default:
        echo 'По умолчанию';
        break;
}
```

**10. Управляющие структуры while, do while, for, foreach**

10.1. while:

```php
while ($expr) {
    // structure body
}
```

10.2. do while:

```php
do {
    // structure body;
} while ($expr);
```

10.3. for:

```php
for ($i = 0; $i < 10; $i++) {
    // тело for
}
```

10.4. foreach:

```php
foreach ($iterable as $key => $value) {
    // тело foreach
}
```

**11. Управляющие структуры try, catch:**

```php
try {
     // тело try
} catch (FirstExceptionType $e) {
    // тело catch
} catch (OtherExceptionType $e) {
    // catch body
}
```


**12. Общие правила управляющих структур:**

12.1. После ключевого слова управляющей структуры НЕОБХОДИМ один пробел;

12.2. После открывающей круглой скобки пробел НЕДОПУСТИМ;

12.3. Перед закрывающей круглой скобкой пробел НЕДОПУСТИМ;

12.4. НЕОБХОДИМ один пробел между закрывающей круглой скобкой и открывающей фигурной скобкой;

12.5. Тело управляющей структуры НЕОБХОДИМО смещать на один отступ;

12.6. Закрывающую фигурную скобку НЕОБХОДИМО располагать на следующей строке после тела.

12.7. Тело каждой управляющей структуры НЕОБХОДИМО заключать в фигурные скобки. Это стандартизирует вид управляющих структур и уменьшает вероятность возникновения ошибок при добавлении новых строк в тело.

**13. Замыкания.**

13.1. В объявлении замыкания НЕОБХОДИМ пробел после ключевого слова function, а также до и после ключевого слова use.

13.2. Открывающую фигурную скобку НЕОБХОДИМО располагать на той же строке; закрывающую фигурную скобку НЕОБХОДИМО располагать на следующей строке после тела замыкания.

13.3. НЕДОПУСТИМЫ пробелы после открывающей круглой скобки списка аргументов или переменных, и НЕДОПУСТИМЫ пробелы перед закрывающей круглой скобкой списка аргументов или переменных.

13.4. В списке аргументов и в списке переменных НЕДОПУСТИМЫ пробелы перед запятыми, и НЕОБХОДИМ один пробел после каждой запятой.

13.5. Аргументы замыкания со значениями по умолчанию НЕОБХОДИМО располагать в конце списка аргументов.

13.6. Список аргументов и список переменных МОЖНО разбить на несколько строк, каждая из которых с одним отступом. При этом первый элемент в списке НЕОБХОДИМО перенести на следующую строку, и в каждой строке НЕОБХОДИМО указать только один аргумент или одну переменную.

13.6. Когда последний список (или аргументов, или переменных) разбит на несколько строк, закрывающую круглую скобку и открывающую фигурную НЕОБХОДИМО располагать на одной отдельной строке, с одним пробелом между ними.

```php
$noArgs_longVars = function () use (
    $longVar1,
    $longerVar2,
    $muchLongerVar3
) {
   // тело
};
```

**Общие рекомендации, при написании кода на PHP:**

1. Комментарии НЕОБХОДИМО делать обширными, но не везде где вздумается, поскольку код сам по себе должен быть ясен по названию функций и переменных. НЕОБХОДИМО комментировать описание классов.

2. Функции и методы, также НЕОБХОДИМО комментировать, особенно если они требуют параметры ввода.

3. Логические операторы ```AND``` и ```OR``` НЕОБХОДИМО записывать, как ```&&``` и ```||``` соответственно.

4. Строки всегда НЕОБХОДИМО размещать в двойные кавычки. При необходимости встроить в строку переменную используйте фигурные скобки: «My string {$foo}»

**Ну и самое главное, это — не краткость кода, а его простота и читаемость.**



